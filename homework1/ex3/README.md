# Упражнение 3

## Вопрос
Выясните, что происходит с файлами, открытыми в процессе, когда данный процесс вызывает системный вызов fork()?

## Ответ 
При вызове функции fork текущий процесс клонируется, и дочерний процесс отличается от родительского только результатом вызова функции fork(ну, почти).

Если результат 0, то это дочерний процесс, иначе - родительский.

Дочерний процесс наследует все системные ресурсы, включая открытые файлы. Для дескрипторов файлов поведение аналогично поведению дескрипторов, полученных с помощью dup/dup2. 
Для каждого файла в Linux есть системная структура `struct file`, которая содержит счетчик использования, текущее положение указателя в файле и т.п. И родительский, и дочерний процессы разделяют эту структуру. Таким образом seek в одном процессе приведет к смене позиции файла в другом процессе.

При закрытии файла уменьшается счетчик использования, и ресурсы будут освобождены, когда все процессы закроют файл.